<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport"
content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<title>Police OT</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"
crossorigin="anonymous"></script>

<style>
:root{--blue:#0a3a8f}
*{box-sizing:border-box}
body{
margin:0;
font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Arial;
background:#f2f2f7;
padding-bottom:40px;
}
h1,h2{text-align:center;margin:12px 0}
label{font-size:.85rem;font-weight:600}
input,select,button{
width:100%;
padding:10px;
margin-top:6px;
border-radius:10px;
border:1px solid #ccc;
font-size:.9rem;
text-align:left;
}
.card{
max-width:420px;
margin:70px auto 24px;
background:#fff;
border-radius:16px;
padding:16px;
box-shadow:0 8px 20px rgba(0,0,0,.08);
}
.field{margin-top:10px}
button.primary{
background:var(--blue);
color:#fff;
border:none;
font-weight:700;
margin-top:12px;
}
.result{
background:#f5f5f7;
border-radius:12px;
padding:12px;
margin-top:12px;
}
.row{
display:flex;
justify-content:space-between;
margin:6px 0;
font-size:.9rem;
}
.entry{
background:#fff;
border-radius:12px;
padding:10px;
margin-top:10px;
font-size:.85rem;
}
.entry img{
max-width:100%;
border-radius:8px;
margin-top:6px;
}
.entry-actions{
display:flex;
gap:8px;
margin-top:6px;
}
.entry-actions button{
flex:1;
padding:6px;
font-size:.8rem;
}

/* MENU */
#menuBtn{
position:fixed;
top:12px;
right:12px;
width:44px;
height:44px;
border-radius:12px;
border:none;
background:var(--blue);
color:#fff;
font-size:22px;
z-index:2000;
}
#sideMenu{
position:fixed;
top:0;
left:-260px;
width:240px;
height:100%;
background:var(--blue);
padding:20px;
transition:left .3s;
z-index:1999;
}
#sideMenu h3{color:#fff;margin-top:40px}
#sideMenu button{
width:100%;
padding:12px;
border:none;
border-radius:10px;
margin:10px 0;
font-weight:700;
}

/* DISCLAIMER */
#disclaimer{
position:fixed;
inset:0;
background:rgba(0,0,0,.6);
display:flex;
align-items:center;
justify-content:center;
z-index:5000;
}
</style>
</head>

<body>

<!-- DISCLAIMER -->
<div id="disclaimer">
  <div style="background:#fff;border-radius:16px;padding:20px;max-width:360px;width:90%">
    <h2>Disclaimer</h2>
    <p style="font-size:.9rem;line-height:1.45">
      The figures used in this application are <b>not guaranteed to be 100% accurate</b>.<br><br>
      They are intended to be as close as possible and may be outdated,
      particularly following recent pay awards or changes.<br><br>
      This app is for guidance only and must not be relied upon as an official calculation.
    </p>
    <label style="display:flex;align-items:center;font-size:.85rem">
      <input type="checkbox" id="dontShowAgain" style="margin-right:8px">
      Don’t show again
    </label>
    <button class="primary" onclick="acceptDisclaimer()">I Understand</button>
  </div>
</div>

<button id="menuBtn">☰</button>

<div id="sideMenu">
<h3>Menu</h3>
<button onclick="show('ot')">Police Overtime</button>
<button onclick="show('acting')">Acting Up</button>
<button onclick="show('log')">Log</button>
<button onclick="clearAll()">Clear All Data</button>
</div>

<!-- ================= OVERTIME ================= -->
<div class="card" id="screen-ot">
<h2>Police Overtime</h2>

<div class="field">
<label>Force</label>
<select id="force">
<option value="Metropolitan Police">Metropolitan Police</option>
<option value="Other Home Office Force">Other Home Office Force</option>
</select>
</div>

<div class="field">
<label>Warrant Number</label>
<input id="warrant" placeholder="P123456">
</div>

<div class="field">
<label>Date</label>
<input type="date" id="date">
</div>

<div class="field">
<label>Start Time</label>
<input type="time" id="start">
</div>

<div class="field">
<label>Finish Time</label>
<input type="time" id="finish">
</div>

<div class="field">
<label>Total Hours</label>
<input id="hours" readonly>
</div>

<div class="field">
<label>Expense</label>
<select id="expense">
<option value="0">None</option>
<option value="7.50">Breakfast £7.50</option>
<option value="7.50">Lunch £7.50</option>
<option value="15.00">Dinner £15.00</option>
</select>
</div>

<div class="field">
<label>Receipt</label>
<input type="file" id="receipt" accept="image/*">
</div>

<button class="primary" onclick="saveOT()">Save Overtime</button>
<button class="primary" onclick="exportPDF()">Claims PDF</button>
</div>

<!-- ================= ACTING UP ================= -->
<div class="card" id="screen-acting" style="display:none">
<h2>Acting Up Allowance</h2>
<p style="text-align:center;font-size:.85rem">No PDF export for Acting Up</p>
</div>

<!-- ================= LOG ================= -->
<div class="card" id="screen-log" style="display:none">
<h2>Log</h2>
<div id="log"></div>
</div>

<script>
const STORE="policeOT";
const qs=i=>document.getElementById(i);

/* DISCLAIMER */
function acceptDisclaimer(){
localStorage.setItem("disclaimerAccepted","true");
qs("disclaimer").style.display="none";
}
if(localStorage.getItem("disclaimerAccepted")==="true"){
qs("disclaimer").style.display="none";
}

/* TIME */
function hoursBetween(s,f){
if(!s||!f)return"";
let [sh,sm]=s.split(":").map(Number);
let [fh,fm]=f.split(":").map(Number);
let m=(fh*60+fm)-(sh*60+sm);
if(m<0)m+=1440;
return(Math.round(m/15)*15/60).toFixed(2);
}
["start","finish"].forEach(i=>qs(i).onchange=()=>{
qs("hours").value=hoursBetween(qs("start").value,qs("finish").value);
});

/* STORAGE */
function load(){return JSON.parse(localStorage.getItem(STORE)||"[]")}
function save(d){localStorage.setItem(STORE,JSON.stringify(d))}

/* SAVE OT */
function saveOT(){
let img=qs("receipt").files[0]?URL.createObjectURL(qs("receipt").files[0]):null;
let d=load();
d.push({
force:qs("force").value,
warrant:qs("warrant").value,
date:qs("date").value,
start:qs("start").value,
finish:qs("finish").value,
hours:qs("hours").value,
expense:qs("expense").value,
receipt:img
});
save(d);renderLog();show("log");
}

/* LOG */
function renderLog(){
qs("log").innerHTML="";
load().forEach((e,i)=>{
qs("log").innerHTML+=`
<div class="entry">
<b>${e.force}</b><br>
Warrant: ${e.warrant}<br>
${e.date}<br>
${e.start} - ${e.finish} (${e.hours} hrs)<br>
Expense £${e.expense}
${e.receipt?`<img src="${e.receipt}">`:""}
<div class="entry-actions">
<button onclick="exportPDF(${i})">Export PDF</button>
<button onclick="del(${i})">Delete</button>
</div>
</div>`;
});
}
function del(i){
let d=load();d.splice(i,1);save(d);renderLog();
}
function clearAll(){
localStorage.clear();
renderLog();
}

/* PDF EXPORT — EXACT CLAIM FORMAT */
function exportPDF(index=null){
const e=index!==null?load()[index]:load().slice(-1)[0];
if(!e)return;

const { jsPDF } = window.jspdf;
const pdf=new jsPDF();

pdf.setFontSize(16);
pdf.text(e.force,20,20);

pdf.setFontSize(11);
pdf.text(`Warrant Number: ${e.warrant}`,20,40);
pdf.text(`Date: ${e.date}`,20,50);
pdf.text(`Start Time: ${e.start}`,20,60);
pdf.text(`Finish Time: ${e.finish}`,20,70);
pdf.text(`Number of Hours: ${e.hours}`,20,80);
pdf.text(`Expense Amount: £${e.expense}`,20,90);

if(e.receipt){
pdf.addImage(e.receipt,"JPEG",20,105,60,60);
}

pdf.save(`Police_OT_Claim_${e.date}.pdf`);
}

/* NAV */
function show(s){
["ot","acting","log"].forEach(x=>qs("screen-"+x).style.display="none");
qs("screen-"+s).style.display="block";
qs("sideMenu").style.left="-260px";
}
qs("menuBtn").onclick=()=>{
qs("sideMenu").style.left=
qs("sideMenu").style.left==="0px"?"-260px":"0px";
};
</script>
</body>
</html>
